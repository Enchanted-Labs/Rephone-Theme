{% assign selected_variant = product.selected_or_first_available_variant %}
<style>
  .variant-a {
    display: block;
  }

  .variant-b {
    display: none;
  }
  label {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 40px;
    width: 40px;
    border-radius: 8px;
    border: 1px solid #e5e5e5;
    position: relative;
  }
  label input {
    display: none;
  }
  label span {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 40px;
    width: 40px;
    border-radius: 8px;
    border: 1px solid #e5e5e5;
    font-size: 12px;
    line-height: 22px;
    margin: 5px 0;
  }
  input:checked + span {
    background: #29a7bf;
    color: white;
  }
  input:checked label span {
    color: white;
  }
</style>

<div class="container product-details">
  <section class="breadcrumbs">
    <div class="item-parent col-12 col-lg-6">
      <ul class="item-parent">
        {% for breadcrumb in breadcrumbs %}
          <li class="item">
            <a href="{{ breadcrumb.href }}">
              <p>{{ breadcrumb.text }}</p>
            </a>
          </li>
        {% endfor %}
      </ul>
    </div>
  </section>
  <section class="brands d-md-none mobile-line-after" style="display: none;">
    <a href="https://www.thuiswinkel.org/leden/rephone/certificaat" target="_blank">
      <div class="img"></div>
      <div class="img"></div>
      <div class="img"></div>
    </a>
  </section>
  <div class="row d-flex flex-column-reverse flex-lg-row" itemscope itemtype="http://schema.org/Product">
    <section class="left-sidebar col-12 col-lg-4">
      <div class="inner">
        <div class="product d-none d-lg-block">
          <img itemprop="image" src="{{ product.featured_image | img_url: 'master' }}" class="headthumb" title="{{ product.title }}" alt="{{ product.title }}" style="width: 288px ;"/>
        </div>
        <div class="product-images d-none d-lg-block">
          <div class="item-parent">
            {% for media in product.media %}
              <div class="item">
                <img src="{{ media | image_url }}" class="thumb" title="{{ product.title }}" alt="{{ product.title }}" style="height: 50px;"/>
              </div>
            {% endfor %}
          </div>
        </div>
        <div class="unboxing" style="display: none;">
          <h4>Unboxing Rephone</h4>
          <div class="img"></div>
        </div>
        <div class="included d-lg-none mb-0">
          <h4 class="mb-3">Standaard meegeleverd</h4>
          <div class="item-parent">
            <div class="row">
              {% for block in section.blocks %}
                {% case block.type %}
                  {% when 'addition' %}
                    <div class="item col-6 mb-3">
                      <div class="inner">
                        <img src="{{block.settings.addition-image | img_url: 'master'}}" class="img" alt="Apple Earpods" style="width: 50px;"/>
                      </div>
                    </div>
                {% endcase %}
              {% endfor %}
            </div>
          </div>
        </div>
        <div class="text-content d-lg-none mt-3">
          <div class="text">
            <p>{{ product.description }}</p>
          </div>
        </div>
        <div class="lookouts-accordion d-lg-none mt-4">
          <div id="accordion">
            <div class="card" style="display: none;">
              <div class="card-header" id="headingOne">
                <h5 class="mb-0">
                  <button class="btn" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                    <h4>Waar moet ik op letten?</h4>
                    <i class="fal fa-chevron-down"></i>
                  </button>
                </h5>
              </div>
              <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordion">
                <div class="card-body">
                  <p>Lorem ipsum dolor sit amet.</p>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="card-header" id="headingTwo">
                <h5 class="mb-0">
                  <button class="btn" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="true" aria-controls="collapseTwo">
                    <h4>Rephone op TV</h4>
                    <i class="fal fa-chevron-down"></i>
                  </button>
                </h5>
              </div>
              <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
                <div class="card-body">
                  <iframe src="https://www.youtube.com/embed/fDWeSPuKdu0?enablejsapi=1&amp;origin=https%3A%2F%2Fwww.rephone.nl" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" data-gtm-yt-inspected-8="true" id="807589892" data-gtm-yt-inspected-8312312_46="true" title="Rephone item Doe maar Duurzaam S11E12 RTLZ 23 december 2018" width="375" height="210" frameborder="0"></iframe>
                </div>
              </div>
            </div>
            <div class="card" style="display: none;">
              <div class="card-header" id="headingThree">
                <h5 class="mb-0">
                  <button class="btn" data-toggle="collapse" data-target="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
                    <h4>Wat zijn de specs</h4>
                    <i class="fal fa-chevron-down"></i>
                  </button>
                </h5>
              </div>
              <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
                <div class="card-body">
                  <p>Lorem ipsum dolor sit amet.</p>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="card-header" id="headingFour">
                <h5 class="mb-0">
                  <button class="btn" data-toggle="collapse" data-target="#collapseFour" aria-expanded="true" aria-controls="collapseFour">
                    <h4>Reviews</h4>
                    <i class="fal fa-chevron-down"></i>
                  </button>
                </h5>
              </div>
              <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#accordion">
                <div class="card-body">
                  {% for block in section.blocks %}
                    {% case block.type %}
                      {% when 'accordion-reviews' %}
                        <div class="review">
                          <div class="title">
                            <p>{{block.settings.person-name}} | {{block.settings.person-city}}</p>
                          </div>
                          <div class="star-ratings-css blue-stars">
                            <div class="star-ratings-css-top" style="width: 100%">
                              <span>★</span>
                              <span>★</span>
                              <span>★</span>
                              <span>★</span>
                              <span>★</span>
                            </div>
                            <div class="star-ratings-css-bottom">
                              <span>★</span>
                              <span>★</span>
                              <span>★</span>
                              <span>★</span>
                              <span>★</span>
                            </div>
                          </div>
                          <div class="text">
                            {{block.settings.person-description}}
                          </div>
                        </div>
                    {% endcase %}
                  {% endfor %}
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="unboxing" id="fixedOnScroll">
          <div class="why-buy-here mt-4">
            <div class="inner">
              <h4>Waarom bij ons kopen</h4>
              <div class="check-marks green">
                {% for block in section.blocks %}
                  {% case block.type %}
                    {% when 'additional-lines' %}
                      <div class="check-mark">
                        <i class="fal fa-check-circle"></i>
                        <p>
                          <a href="{{block.settings.line-link}}">{{block.settings.line-text}}</a>
                        </p>
                      </div>
                  {% endcase %}
                {% endfor %}
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="main-content mt-lg-0 col-12 col-lg-8">
      <div class="inner">
        <div class="options-info">
          {% for block in section.blocks %}
            {% case block.type %}
              {% when 'title' %}
                <div class="title">
                  <h1 itemprop="name" style="font-size: 40px; margin:0;">{{product.title}}</h1>
                  <h3>{{ block.settings.storage-text}} | | 2 jaar garantie</h3>
                  <h4>Volledig functioneel & simlockvrij</h4>
                </div>
            {% endcase %}
          {% endfor %}
          <div style="display: none;" itemprop="description">{{ description }}</div>
          <div itemprop="offers" itemscope itemtype="http://schema.org/Offer" style="display: none;">
            <span itemprop="priceCurrency" content="EUR">&euro;</span>
            <span itemprop="price" content="{{ rs_price }}">{{ price }}</span>
            {% if quantity > 0 %}
              <link itemprop="availability" href="http://schema.org/InStock"/>
            {% else %}
              <link itemprop="availability" href="http://schema.org/OutOfStock"/>
            {% endif %}
            <span itemprop="priceValidUntil">2030-01-01</span>
            <span itemprop="url">{{ href }}</span>
          </div>
          <div class="product d-lg-none">
            <div class="row">
              <div class="col-9 thumbnail-big">
                <div class="inner">
                  <img src="{{ product.featured_image | img_url: 'master' }}" class="headthumb" title="{{ product.title }}" alt="{{ product.title }}" style="height: 190px;"/>
                </div>
              </div>
              <div class="col-2 thumbnail-small">
                {% for media in product.media %}
                  <div class="item">
                    <div class="inner">
                      <img src="{{ media | image_url }}" class="thumb" title="{{ product.title }}" alt="{{ product.title }}" style="height: 38px;"/>
                    </div>
                  </div>
                {% endfor %}
              </div>
            </div>
          </div>
          <div class="options mobile-line-after mobile-line-before">
            <div class="row">
              <div class="col-12 col-lg-8 color-options">
                <h4>Kleur</h4>
                <div class="row">
                  {% for block in section.blocks %}
                    {% case block.type %}
                      {% when 'color_selector' %}
                        <a href="{{block.settings.variant-link}}" class="color col-2 col-lg-2">
                          <div class="img" style="background:{{block.settings.variant-color}};margin: 0px auto;"></div>
                          <p>{{ block.settings.variant-text }}</p>
                        </a>
                    {% endcase %}
                  {% endfor %}
                </div>
              </div>
              <div style="clear: both; width: 100%;"></div>
              <div class="col-12 col-lg-8 storage-options">
                <h4>Opslag</h4>
                <div class="row">
                  {% for block in section.blocks %}
                    {% case block.type %}
                      {% when 'storage_selector' %}
                        <a href="{{block.settings.storage-link}}" class="storage col-2 col-lg-2">
                          <div class="img" style="margin: 0px auto;">
                            <p>{{ block.settings.storage-text }}</p>
                          </div>
                        </a>
                    {% endcase %}
                  {% endfor %}
                </div>
              </div>
              <div style="clear: both; width: 100%; height: 20px;"></div>
            </div>
          </div>
          <div class="condition mt-5 mt-lg-0">
            <div class="cart">
              <div class="title">
                <div class="row">
                  <div class="col-4 col-md-6">
                    <h4>Behuizing</h4>
                  </div>
                  <div class="col-8 col-md-6">
                    <div class="blue" data-toggle="modal" data-target="#productConditions">
                      <p>Meer weten over de behuizingconditie?</p>
                    </div>
                  </div>
                </div>
              </div>
              <style>
                .btn-cart {
                  width: 100% !important;
                  cursor: pointer;
                }

                @media screen and (max-width: 991px) {
                  .btn-cart {
                    font-size: 11px;
                  }
                }
              </style>
              {% for block in section.blocks %}
                {% case block.type %}
                  {% when 'grade_buttons' %}
                    <div class="cart-item mobile-line-after mobile-line-before" style="opacity:100%;">
                      <div class="row no-gutters">
                        <div class="col-4 col-md-3">
                          <p>
                            {{block.settings.grade-text}}
                            <br>
                            <span>
                              {{block.settings.grade-sub-text}}
                            </span>
                          </p>
                        </div>
                        <div class="col-4 col-md-3 price">
                          <p class="blue">{{ block.settings.grade-price }}</p>
                        </div>
                        <div class="stock no-stock col-3 d-none d-md-flex">
                          <p>Uitverkocht</p>
                          <p>Ontvang een e-mail bij voorraad</p>
                        </div>
                        <div class="col-4 col-md-3 d-flex justify-content-end">
                          <div class="btn-cart stockemail" data-toggle="modal" data-product-option="option[{{ option.product_option_id }}]" data-product-option-value-id="{{ option_value.product_option_value_id }}" data-product-option-value-name="{{ option_value.name }}" data-product-id="{{ product_id }}" data-product-option-value-price="{{ option_value.voor }}" data-option-value-id="{{ option_value.option_value_id }}" data-target="#stockemail" style="background:  #29a7bf; border-bottom: #29a7bf;">
                            <i class="fal fa-envelope"></i>&nbsp;
                            {{block.settings.grade-button-label}}
                          </div>
                        </div>
                      </div>
                      <div class="row no-gutters mobile">
                        <div class="stock no-stock col-12 d-none">
                          <p>Uitverkocht ontvang een e-mail bij voorraad</p>
                        </div>
                      </div>
                    </div>
                {% endcase %}
              {% endfor %}
            </div>
          </div>
          <p>* Al onze aparaten zijn ingekocht van Nederlandse consumenten waardoor marge BTW van toepassing is</p>
        </div>

        {% if name_split.type != ''%}
          <div class="included d-none d-lg-block">
            <h4>Wat zit er nog meer in de doos?</h4>
            <div class="item-parent">
              {% for block in section.blocks %}
                {% case block.type %}
                  {% when 'addition' %}
                    <div class="item">
                      <img src="{{block.settings.addition-image | img_url: 'master'}}" alt="Simpin" class="img"/>
                    </div>
                {% endcase %}
              {% endfor %}
            </div>
          </div>
        {% else %}
          <p class="blue" style="font-size: 40px; font-weight: bold; margin-bottom: 20px;">{{ price }}</p>
          <a class="btn-cart btn-green addtocart" data-product-id="{{ product_id }}" style="color: #fff;">Voeg toe aan
            winkelwagen</a>
        {% endif %}
        {% for block in section.blocks %}
          {% case block.type %}
            {% when 'description' %}
              <div class="text-content d-none d-lg-block">
                <div class="text">
                  <p>{{ product.description }}</p>
                </div>
              </div>
          {% endcase %}
        {% endfor %}
        <div class="lookouts d-none d-lg-block" style="display: none!important;">
          <h3>Waar moet ik op letten?</h3>
          <div class="row">
            <div class="col-6">
              <div class="check-marks pros">
                <div class="check-mark">
                  <i class="fal fa-check-circle"></i>
                  <p>Ontgrendel razendsnel jouw telefoon met je gezicht (Face ID)</p>
                </div>
                <div class="check-mark">
                  <i class="fal fa-check-circle"></i>
                  <p>Maak professionele foto�s en video�s met twee 12-megapixel camera�s</p>
                </div>
                <div class="check-mark">
                  <i class="fal fa-check-circle"></i>
                  <p>Geen kabel bij de hand? Je kunt de iPhone X ook draadloos opladen</p>
                </div>
                <div class="check-mark">
                  <i class="fal fa-check-circle"></i>
                  <p>De nieuwe A11-processor maakt de iPhone X krachtiger en energiezuiniger dan andere iPhones</p>
                </div>
              </div>
            </div>
            <div class="col-6">
              <div class="check-marks cons">
                <div class="check-mark">
                  <i class="fal fa-minus-circle"></i>
                  <p>Als je een voorkeur hebt voor touch ID, dan kan Face ID even wennen zijn</p>
                </div>
                <div class="check-mark">
                  <i class="fal fa-minus-circle"></i>
                  <p>De iPhone X heeft geen hoofdtelefoon aansluiting (headphone jack)</p>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="specs d-none d-lg-block" style="display: none!important;">
          <h3>Wat zijn de specs?</h3>

          <div class="spec">
            <div class="row no-gutters">
              <p class="col-6">Processor</p>
              <p class="col-6">Apple A11 Bionic</p>
            </div>
            <div class="row no-gutters">
              <p class="col-6">Kleur</p>
              <p class="col-6">Zwart / Space Grey</p>
            </div>
            <div class="row no-gutters">
              <p class="col-6">Geheugen</p>
              <p class="col-6">64gb</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="right-sidebar col-12 col-lg-3 d-none d-lg-block" style="display: none!important;">
      <div class="inner">
        <div class="why-buy-here" style="display:none;">
          <h4>Waarom bij ons kopen</h4>
          <div class="check-marks">
            {% for block in section.blocks %}
              {% case block.type %}
                {% when 'additional-lines' %}
                  <div class="check-mark">
                    <i class="fal fa-check-circle"></i>
                    <p>
                      <a href="garantie/">Twee jaar garantie op je refurbished apparaat</a>
                    </p>
                  </div>
              {% endcase %}
            {% endfor %}
          </div>
        </div>

        <a href="https://www.thuiswinkel.org/leden/rephone/certificaat" target="_blank" class="brands d-none d-lg-flex">
          <div class="img"></div>
          <div class="img"></div>
          <div class="img"></div>
        </a>

        <div class="questions d-none d-lg-block">
          <div class="row ask">
            <div class="col-8">
              <h3>Vragen?</h3>
            </div>
          </div>
          <div class="row mt-1 mb-2">
            <div class="col-12 contact">
              <div class="call">
                <i class="far fa-phone"></i>
                <p>
                  <a href="tel:085 1301 646" onclick="ga('send', 'event', { eventCategory: 'klik op telnr', eventAction: 'bellen', eventLabel: 'contact'});">085
                    1301 646</a>
                </p>
              </div>
            </div>
          </div>
          <div class="openings-hours">
            <div class="item">
              <div class="row no-gutters">
                <p class="col-12">maandag t/m vrijdag: <br>8:00 - 18:00</p>
              </div>
            </div>
          </div>
        </div>

        <div class="reviews d-none d-lg-block">
          <h4 class="mb-3">Reviews over dit product</h4>
          {% for review in kiyoh_reviews %}
            <div class="review">
              <div class="title">
                <p>{{ review.customer_name }} | {{ review.customer_place }}</p>
              </div>
              <div class="star-ratings-css blue-stars">
                <div class="star-ratings-css-top" style="width: {{ review.percentage }}%">
                  <span>&starf;</span>
                  <span>&starf;</span>
                  <span>&starf;</span>
                  <span>&starf;</span>
                  <span>&starf;</span>
                </div>
                <div class="star-ratings-css-bottom">
                  <span>&starf;</span>
                  <span>&starf;</span>
                  <span>&starf;</span>
                  <span>&starf;</span>
                  <span>&starf;</span>
                </div>
              </div>
              <div class="text">
                <p>{{ review.positive }}</p>
              </div>
            </div>
          {% endfor %}


          <a href="https://www.kiyoh.nl/rephone/" target="_blank" rel="nofollow" class="blue-underline">
            <p>Lees alle reviews</p>
            <i class="far fa-arrow-right"></i>
          </a>
        </div>

        <div class="trade-old-phone d-none d-lg-block">
          <h4>Oude iPhone inruilen?</h4>
          <p>
            Oude iPhone waar je nog geld voor kan krijgen? Lever hem bij ons in en ontvang binnen 24 uur je geld!
          </p>

          <a href="inruilen/" class="btn-green">Ruil je iPhone in</a>
        </div>
      </div>
    </section>
  </div>
</div>



<script>
  class VariantSelector extends HTMLElement {
    constructor() {
      super();
      this.addEventListener("change", this.onVariantChange);
    }

    onVariantChange() {
      this.getSelectedOptions();
      this.getSelectedVariant();
      if (this.currentVariant) {
        this.updateURL();
        this.updateFormID();
        this.updatePrice();
      }
    }

    getSelectedOptions() {
      this.options = Array.from(this.querySelectorAll('select'), (select) => select.value);
      console.log(this.options);
    }

    getVariantJSON() {
      this.variantData = this.variantData || JSON.parse(this.querySelector('[type="application/json"]').textContent);
      return this.variantData;
    }

    getSelectedVariant() {
      this.currentVariant = this.getVariantJSON().find(variant => {
        const findings = !variant.options.map((option, index) => {
          return this.options[index] === option;
        }).includes(false);
        if (findings) 
          return variant;
        



      });
      console.log(this.currentVariant);
    }

    updateURL() {
      if (!this.currentVariant) 
        return;
      



      window.history.replaceState({}, '', `${
        this.dataset.url
      }?variant=${
        this.currentVariant.id
      }`);
    }

    updateFormID() {
      const form_input = document.querySelector("#product-form").querySelector('input[name="id"]');
      form_input.value = this.currentVariant.id;
    }

    updatePrice() {
      fetch(`${
        this.dataset.url
      }?variant=${
        this.currentVariant.id
      }&section_id=${
        this.dataset.section
      }`).then((response) => response.text()).then((responseText) => {
        const id = `price-${
          this.dataset.section
        }`;
        const html = new DOMParser().parseFromString(responseText, 'text/html');
        const oldPrice = document.getElementById(id);
        const newPrice = html.getElementById(id);
        if (oldPrice && newPrice) 
          oldPrice.innerHTML = newPrice.innerHTML;
        



      });
    }
  }
  customElements.define("variant-selector", VariantSelector);
</script>
<script>
  jQuery(function($) {
    $(".info-title").click(function() {
      $(this).closest('.info-tab').toggleClass('no-border');
    });
  });
</script>

{% schema %}
  {
    "name": "Product Section",
    "tag": "section",
    "class": "products",
    "settings": [],
    "blocks": [
      {
        "type": "title",
        "name": "Title",
        "limit": 1,
        "settings": [
          {
            "type": "text",
            "id": "storage-text",
            "label": "Storage Text"
          }
        ]
      },
      {
        "type": "description",
        "name": "Description",
        "limit": 1
      },
      {
        "type": "review",
        "name": "Review",
        "limit": 1,
        "settings": [
          {
            "type": "liquid",
            "id": "review",
            "label": "Review"
          }
        ]
      },
      {
        "type": "price",
        "name": "Price",
        "limit": 1
      }, {
        "type": "color_selector",
        "name": "Color Selector",
        "settings": [
          {
            "type": "url",
            "id": "variant-link",
            "label": "Color Link"
          }, {
            "type": "color",
            "id": "variant-color",
            "label": "Color"
          }, {
            "type": "text",
            "id": "variant-text",
            "label": "Color Text"
          }
        ]
      }, {
        "type": "storage_selector",
        "name": "Storage Selector",
        "settings": [
          {
            "type": "url",
            "id": "storage-link",
            "label": "Storage Link"
          }, {
            "type": "text",
            "id": "storage-text",
            "label": "Color Text"
          }
        ]
      }, {
        "type": "grade_buttons",
        "name": "Grade Buttons",
        "limit": 3,
        "settings": [
          {
            "type": "text",
            "id": "grade-text",
            "label": "Grade Text"
          }, {
            "type": "text",
            "id": "grade-sub-text",
            "label": "Grade Sub Text"
          }, {
            "type": "text",
            "id": "grade-price",
            "label": "Grade Price"
          }, {
            "type": "text",
            "id": "grade-button-label",
            "label": "Grade Button Label"
          }
        ]
      }, {
        "type": "additional-lines",
        "name": "Additional Lines",
        "settings": [
          {
            "type": "url",
            "id": "line-link",
            "label": "Line Link"
          }, {
            "type": "text",
            "id": "line-text",
            "label": "Line Text"
          }
        ]
      }, {
        "type": "accordion-reviews",
        "name": "Accordion Reviews",
        "settings": [
          {
            "type": "text",
            "id": "person-name",
            "label": "Name"
          }, {
            "type": "text",
            "id": "person-city",
            "label": "City"
          }, {
            "type": "richtext",
            "id": "person-description",
            "label": "Review"
          }
        ]
      }, {
        "type": "addition",
        "name": "Box Items",
        "settings": [
          {
            "type": "image_picker",
            "id": "addition-image",
            "label": "Addition Image"
          }
        ]
      }
    ]
  }
{% endschema %}